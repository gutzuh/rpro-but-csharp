<UserControl x:Class="RPRO.App.Views.DashboardRacaoView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:lvc="clr-namespace:LiveChartsCore.SkiaSharpView.WPF;assembly=LiveChartsCore.SkiaSharpView.WPF"
             Background="White">

    <Grid Background="White">
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <StackPanel Margin="24">
                <!-- T칤tulo -->
                <TextBlock Text="游늵 Dashboard de Ra칞칚o" 
                           FontSize="32"
                           FontWeight="Bold"
                           Foreground="#E53935"
                           Margin="0,0,0,8"/>
                
                <TextBlock Text="An치lise de produ칞칚o e performance" 
                           FontSize="14"
                           Foreground="Gray"
                           Margin="0,0,0,24"/>
                <!-- KPIs Principais -->
                <Grid Margin="0,0,0,24">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Total KG -->
                    <Border Grid.Column="0" Background="#FFF3E0" Padding="20" CornerRadius="12" Margin="0,0,8,0">
                        <StackPanel>
                            <TextBlock Text="游낈 Total Produzido" FontSize="13" Foreground="#F57C00" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding TotalKg, StringFormat={}{0:N2}}" 
                                       FontSize="32" 
                                       FontWeight="Bold" 
                                       Foreground="#E53935"
                                       Margin="0,12,0,0"/>
                            <TextBlock Text="kg" FontSize="12" Foreground="#F57C00" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Batidas -->
                    <Border Grid.Column="1" Background="#E3F2FD" Padding="20" CornerRadius="12" Margin="4,0,4,0">
                        <StackPanel>
                            <TextBlock Text="丘뙖잺 Batidas" FontSize="13" Foreground="#1565C0" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding TotalBatidas, StringFormat={}{0:N0}}" 
                                       FontSize="32" 
                                       FontWeight="Bold" 
                                       Foreground="#1E88E5"
                                       Margin="0,12,0,0"/>
                            <TextBlock Text="registros" FontSize="12" Foreground="#1565C0" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- F칩rmulas -->
                    <Border Grid.Column="2" Background="#E8F5E9" Padding="20" CornerRadius="12" Margin="4,0,4,0">
                        <StackPanel>
                            <TextBlock Text="游빍 F칩rmulas" FontSize="13" Foreground="#2E7D32" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding FormulasUnicas, StringFormat={}{0:N0}}" 
                                       FontSize="32" 
                                       FontWeight="Bold" 
                                       Foreground="#43A047"
                                       Margin="0,12,0,0"/>
                            <TextBlock Text="tipos" FontSize="12" Foreground="#2E7D32" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Border>

                    <!-- Performance -->
                    <Border Grid.Column="3" Background="#FCE4EC" Padding="20" CornerRadius="12" Margin="8,0,0,0">
                        <StackPanel>
                            <TextBlock Text="游늳 Performance" FontSize="13" Foreground="#C2185B" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding PerformancePercentual, StringFormat={}{0:N1}}" 
                                       FontSize="32" 
                                       FontWeight="Bold" 
                                       Foreground="#D81B60"
                                       Margin="0,12,0,0"/>
                            <TextBlock Text="%" FontSize="12" Foreground="#C2185B" Margin="0,4,0,0"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Gr치ficos -->
                <Border Background="White" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="12" Padding="20" Margin="0,0,0,24">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Gr치fico por Dia -->
                        <StackPanel Grid.Column="0" Margin="0,0,16,0">
                            <TextBlock Text="游늰 Produ칞칚o 칔ltimos 7 Dias" FontSize="16" FontWeight="SemiBold" Foreground="#333" Margin="0,0,0,12"/>
                            <lvc:CartesianChart Series="{Binding GraficoPorDia}" 
                                                Height="300"
                                                LegendPosition="Bottom"/>
                        </StackPanel>

                        <!-- Gr치fico por F칩rmula -->
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="游댧 Top 10 F칩rmulas" FontSize="16" FontWeight="SemiBold" Foreground="#333" Margin="0,0,0,12"/>
                            <lvc:PieChart Series="{Binding GraficoPorFormula}" 
                                          Height="300"
                                          LegendPosition="Right"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Tabela de Dados -->
                <Border Background="White" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="12" Padding="20" Margin="0,0,0,24">
                    <StackPanel>
                        <TextBlock Text="游늶 칔ltimas Batidas" FontSize="16" FontWeight="SemiBold" Foreground="#333" Margin="0,0,0,12"/>
                        
                        <DataGrid ItemsSource="{Binding UltimasBatidas}" 
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  IsReadOnly="True"
                                  MaxHeight="350"
                                  BorderThickness="0">
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="#F5F5F5"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Foreground" Value="#333"/>
                                    <Setter Property="Padding" Value="12,8"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Data/Hora" Binding="{Binding DataHora, StringFormat={}{0:dd/MM/yyyy HH:mm:ss}}" Width="180"/>
                                <DataGridTextColumn Header="F칩rmula" Binding="{Binding Formula}" Width="150"/>
                                <DataGridTextColumn Header="Peso (kg)" Binding="{Binding Peso, StringFormat={}{0:N2}}" Width="100"/>
                                <DataGridTextColumn Header="Ingredientes" Binding="{Binding NumIngredientes}" Width="100"/>
                                <DataGridTextColumn Header="Operador" Binding="{Binding Operador}" Width="120"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <TextBlock Text="Nenhuma batida registrada" 
                                   Foreground="Gray" 
                                   HorizontalAlignment="Center"
                                   Margin="0,16,0,0"
                                   Visibility="{Binding UltimasBatidas.Count, Converter={StaticResource ZeroToVisibilityConverter}}"/>
                    </StackPanel>
                </Border>

                <!-- Estat칤sticas -->
                <Border Background="#FAFAFA" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="12" Padding="20">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0" Margin="0,0,16,0">
                            <TextBlock Text="M칠dia/Batida" FontSize="12" Foreground="Gray"/>
                            <TextBlock Text="{Binding MediaPorBatida, StringFormat={}{0:N2}}" FontSize="20" FontWeight="Bold" Foreground="#E53935" Margin="0,8,0,0"/>
                            <TextBlock Text="kg" FontSize="11" Foreground="Gray"/>
                        </StackPanel>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Maior Batida" FontSize="12" Foreground="Gray"/>
                            <TextBlock Text="{Binding MaiorBatida, StringFormat={}{0:N2}}" FontSize="20" FontWeight="Bold" Foreground="#1E88E5" Margin="0,8,0,0"/>
                            <TextBlock Text="kg" FontSize="11" Foreground="Gray"/>
                        </StackPanel>

                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Menor Batida" FontSize="12" Foreground="Gray"/>
                            <TextBlock Text="{Binding MenorBatida, StringFormat={}{0:N2}}" FontSize="20" FontWeight="Bold" Foreground="#43A047" Margin="0,8,0,0"/>
                            <TextBlock Text="kg" FontSize="11" Foreground="Gray"/>
                        </StackPanel>

                        <StackPanel Grid.Column="3">
                            <TextBlock Text="Desvio Padr칚o" FontSize="12" Foreground="Gray"/>
                            <TextBlock Text="{Binding DesvioPadrao, StringFormat={}{0:N2}}" FontSize="20" FontWeight="Bold" Foreground="#F57C00" Margin="0,8,0,0"/>
                            <TextBlock Text="kg" FontSize="11" Foreground="Gray"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Bot칚o Exportar -->
                <Button Command="{Binding ExportarPDFCommand}" 
                        Background="#E53935" 
                        Foreground="White"
                        Padding="16,12"
                        FontSize="14"
                        FontWeight="SemiBold"
                        Margin="0,24,0,0"
                        Width="200"
                        HorizontalAlignment="Left">
                    游늯 Exportar PDF
                </Button>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</UserControl>